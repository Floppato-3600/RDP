name: Ubuntu + xRDP setup

on:
  workflow_dispatch:   # ejecutarlo manualmente desde GitHub, o puedes poner también 'push'

jobs:
  setup-rdp:
    runs-on: ubuntu-latest

    steps:
      - name: Update & install xRDP + desktop
        run: |
          sudo apt update -y
          sudo apt upgrade -y
          # Instalar un entorno gráfico ligero + xRDP
          sudo DEBIAN_FRONTEND=noninteractive apt install -y xfce4 xfce4-goodies xrdp
      - name: Configure xRDP to use xfce session
        run: |
          echo "xfce4-session" | sudo tee /etc/skel/.xsession
          sudo systemctl restart xrdp
      - name: Show xRDP status
        run: sudo systemctl status xrdp
      - name: Print connection info
        run: echo "RDP ready — connect to ${{ runner }} on port 3389 (public IP not exposed for GitHub-hosted runners)"
